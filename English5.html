async function exportWord() {
  if (!document.querySelectorAll("#outputArea .sentence").length) {
    alert("請先翻譯一段文章！");
    return;
  }

  const { Document, Packer, Paragraph, Table, TableCell, TableRow, WidthType, TextRun } = docx;

  let rows = [];

  document.querySelectorAll("#outputArea .sentence").forEach(div => {
    const enText = [...div.querySelectorAll("span.en")].map(s => s.textContent).join("").trim();
    const cnText = div.querySelector(".cn")?.textContent || "";

    rows.push(
      new TableRow({
        children: [
          new TableCell({
            children: [
              new Paragraph({ children: [new TextRun({ text: enText, bold: true })] }),
              new Paragraph({ children: [new TextRun({ text: cnText })] })
            ],
            width: { size: 70, type: WidthType.PERCENTAGE }
          }),
          new TableCell({
            children: [new Paragraph("")],
            width: { size: 30, type: WidthType.PERCENTAGE }
          })
        ]
      })
    );
  });

  const table = new Table({
    rows: rows,
    width: { size: 100, type: WidthType.PERCENTAGE }
  });

  const doc = new Document({
    sections: [
      {
        properties: {},
        children: [table]
      }
    ]
  });

  const blob = await Packer.toBlob(doc);
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "中英文對照.docx";
  a.click();
  URL.revokeObjectURL(url);
}
